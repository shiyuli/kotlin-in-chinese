<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
  <head>
    <title>习惯用语</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta content="" name="description"/>
    <meta content="GitBook 3.2.2" name="generator"/>
    <meta content="huanglizhuo" name="author"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
        
<div class="page">
    
        <h1 class="book-chapter" id="calibre_toc_4">习惯用语</h1>
        <div class="section">
            <h2 id="习惯用语" class="calibre10">习惯用语</h2>
<p class="calibre6">这里是一些在 Kotlin 中经常使用的习语。如果你有特别喜欢的习语想要贡献出来，赶快发起 pull request 吧。</p>
<h3 id="创建dtospojospocos--数据类" class="calibre16">创建DTOs(POJOs/POCOs)  数据类</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3">data <span class="hljs-type"><span class="hljs-keyword">class</span> <span class="hljs-comment">Customer</span></span>(<span class="hljs-variable"><span class="hljs-keyword">val</span> name</span>: String, <span class="hljs-variable"><span class="hljs-keyword">val</span> email</span>: String)
</code></pre>
<p class="calibre6">给 Customer 类提供如下方法：</p>
<blockquote class="calibre18">
<p class="calibre6"> --为所有属性添加 getters ，如果为 var 类型同时添加 setters
 --<code class="calibre19 pcalibre6 pcalibre5">equals()</code>
 --<code class="calibre19 pcalibre6 pcalibre5">haseCode()</code>
 --<code class="calibre19 pcalibre6 pcalibre5">toString()</code>
 --<code class="calibre19 pcalibre6 pcalibre5">copy()</code>
 --<code class="calibre19 pcalibre6 pcalibre5">component1()</code> , <code class="calibre19 pcalibre6 pcalibre5">component1()</code> , ... 参看<a href="Data-Classes.html" class="calibre7 pcalibre2 pcalibre pcalibre1">数据类</a></p>
</blockquote>
<h3 id="函数默认值" class="calibre16">函数默认值</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">foo</span><span class="hljs-params">(a: <span class="hljs-type">Int</span> = 0, b: <span class="hljs-type">String</span> = "")</span> {...}</span>
</code></pre>
<h3 id="过滤-list" class="calibre16">过滤 list</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> positives</span> = list.filter { x -&gt; x &gt;<span class="hljs-params">0</span> }
</code></pre>
<p class="calibre6">或者更短：</p>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> positives</span> = list.filter { it &gt; <span class="hljs-params">0</span> }
</code></pre>
<h3 id="字符串插值" class="calibre16">字符串插值</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3">println(<span class="hljs-string">"Name $name"</span>)
</code></pre>
<h3 id="实例检查" class="calibre16">实例检查</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-keyword">when</span> (x) {
    <span class="hljs-keyword">is</span> Foo -&gt;  ...
    <span class="hljs-keyword">is</span> Bar -&gt; ...
    <span class="hljs-keyword">else</span> -&gt; ...
}
</code></pre>
<h3 id="遍历-maplist" class="calibre16">遍历 map/list</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-keyword">for</span> ((k, v) <span class="hljs-keyword">in</span> map) {
    print(<span class="hljs-string">"$k -&gt; $v"</span>)
}
</code></pre>
<p class="calibre6">k,v 可以随便命名</p>
<h3 id="使用-ranges" class="calibre16">使用 ranges</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-params">1.</span><span class="hljs-params">.100</span>) { ... }  <span class="hljs-comment">// 闭区间: 包括100</span>
<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-params">1</span> until <span class="hljs-params">100</span>) { ... } <span class="hljs-comment">// 半开区间: 不包括100</span>
<span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> <span class="hljs-params">2.</span><span class="hljs-params">.10</span> step <span class="hljs-params">2</span>) { ... }
<span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> <span class="hljs-params">10</span> downTo <span class="hljs-params">1</span>) { ... }
<span class="hljs-keyword">if</span> (x <span class="hljs-keyword">in</span> <span class="hljs-params">1.</span><span class="hljs-params">.10</span>) { ... }
<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-params">1.</span><span class="hljs-params">.100</span>) { ... }
<span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-params">2.</span><span class="hljs-params">.10</span>) { ... }
</code></pre>
<h3 id="只读-list" class="calibre16">只读 list</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3">val list = listOf("a", "b", "c")
</code></pre>
<h3 id="只读map" class="calibre16">只读map</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3">val map = mapOf("a" to 1, "b" to 2, "c" to 3)
</code></pre>
<h3 id="访问-map" class="calibre16">访问 map</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3">println(map["key"])
map["key"] = value
</code></pre>
<h3 id="懒属性延迟加载" class="calibre16">懒属性(延迟加载)</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> p</span>: String by lazy {
    <span class="hljs-comment">// 生成string的值</span>
}
</code></pre>
<h3 id="扩展函数" class="calibre16">扩展函数</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-comment">spcaceToCamelCase</span><span class="hljs-params">()</span> { ... }</span>
<span class="hljs-string">"Convert this to camelcase"</span>.spcaceToCamelCase()
</code></pre>
<h3 id="创建单例模式" class="calibre16">创建单例模式</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-keyword">object</span> Resource {
    <span class="hljs-variable"><span class="hljs-keyword">val</span> name</span> = <span class="hljs-string">"Name"</span>
}
</code></pre>
<h3 id="如果不为空则-的简写" class="calibre16">如果不为空则... 的简写</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> files</span> = File(<span class="hljs-string">"Test"</span>).listFiles()
println(files?.size)
</code></pre>
<h3 id="如果不为空否则-的简写" class="calibre16">如果不为空...否则... 的简写</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> files</span> = File(<span class="hljs-string">"test"</span>).listFiles()
println(files?.size ?: <span class="hljs-string">"empty"</span>)
</code></pre>
<h3 id="如果声明为空执行某操作" class="calibre16">如果声明为空执行某操作</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> data</span> = ...
<span class="hljs-variable"><span class="hljs-keyword">val</span> email</span> = data[<span class="hljs-string">"email"</span>] ?: <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">"Email is missing!"</span>)
</code></pre>
<h3 id="如果不为空执行某操作" class="calibre16">如果不为空执行某操作</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> date</span> = ...
data?.let{
    ...<span class="hljs-comment">//如果不为空执行该语句块</span>
}
</code></pre>
<h3 id="返回-when-判断" class="calibre16">返回 when 判断</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">transform</span><span class="hljs-params">(color: <span class="hljs-type">String</span>)</span>: <span class="hljs-keyword">Int</span> {</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span>(color) {
        <span class="hljs-string">"Red"</span> -&gt; <span class="hljs-params">0</span>
        <span class="hljs-string">"Green"</span> -&gt; <span class="hljs-params">1</span>
        <span class="hljs-string">"Blue"</span> -&gt; <span class="hljs-params">2</span>
        <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">throw</span> IllegalArgumentException(<span class="hljs-string">"Invalid color param value"</span>)
    }
}
</code></pre>
<h3 id="try-catch-表达式" class="calibre16">try-catch 表达式</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">test</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-variable"><span class="hljs-keyword">val</span> result</span> = <span class="hljs-keyword">try</span> {
        count()
    }<span class="hljs-keyword">catch</span> (e: ArithmeticException) {
        <span class="hljs-keyword">throw</span> IllegaStateException(e)
    }
    <span class="hljs-comment">//处理 result</span>
}
</code></pre>
<h3 id="if-表达式" class="calibre16">if 表达式</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">foo</span><span class="hljs-params">(param: <span class="hljs-type">Int</span>)</span>{</span>
    <span class="hljs-variable"><span class="hljs-keyword">val</span> result</span> = <span class="hljs-keyword">if</span> (param == <span class="hljs-params">1</span>) {
        <span class="hljs-string">"one"</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (param == <span class="hljs-params">2</span>) {
        <span class="hljs-string">"two"</span>
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-string">"three"</span>
    }
}
</code></pre>
<h3 id="方法使用生成器模式返回-unit" class="calibre16">方法使用生成器模式返回 Unit</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">arrOfMinusOnes</span><span class="hljs-params">(size: <span class="hljs-type">Int</span>)</span>: IntArray{</span>
    <span class="hljs-keyword">return</span> IntArray(size).apply{ fill(<span class="hljs-params">-1</span>) }
}
</code></pre>
<h3 id="只有一个表达式的函数" class="calibre16">只有一个表达式的函数</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">theAnswer</span><span class="hljs-params">()</span> = 42</span>
</code></pre>
<p class="calibre6">与下面的语句是等效的</p>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">theAnswer</span><span class="hljs-params">()</span>: <span class="hljs-keyword">Int</span> {</span>
    <span class="hljs-keyword">return</span> <span class="hljs-params">42</span>
}
</code></pre>
<p class="calibre6">这个可以和其它习惯用语组合成高效简洁的代码。譬如说 when 表达式：</p>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">transform</span><span class="hljs-params">(color: <span class="hljs-type">String</span>)</span>: <span class="hljs-keyword">Int</span> = <span class="hljs-comment">when</span> <span class="hljs-params">(color)</span> {</span>
    <span class="hljs-string">"Red"</span> -&gt; <span class="hljs-params">0</span>
    <span class="hljs-string">"Green"</span> -&gt; <span class="hljs-params">1</span>
    <span class="hljs-string">"Blue"</span> -&gt; <span class="hljs-params">2</span>
    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">throw</span> IllegalArgumentException(<span class="hljs-string">"Invalid color param value"</span>)
}
</code></pre>
<h3 id="利用-with-调用一个对象实例的多个方法" class="calibre16">利用 with 调用一个对象实例的多个方法</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-type"><span class="hljs-keyword">class</span> <span class="hljs-comment">Turtle</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">penDown</span><span class="hljs-params">()</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">penUp</span><span class="hljs-params">()</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">turn</span><span class="hljs-params">(degrees: <span class="hljs-type">Double</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-comment">forward</span><span class="hljs-params">(pixels: <span class="hljs-type">Double</span>)</span></span>
}
<span class="hljs-variable"><span class="hljs-keyword">val</span> myTurtle</span> = Turtle()
with(myTurtle) { <span class="hljs-comment">// 画一个100像素的正方形</span>
    penDown()
    <span class="hljs-keyword">for</span>(i <span class="hljs-keyword">in</span> <span class="hljs-params">1.</span><span class="hljs-params">.4</span>) {
    forward(<span class="hljs-params">100.0</span>)
        turn(<span class="hljs-params">90.0</span>)
    }
    penUp()
}
</code></pre>
<h3 id="java-7s-try-with-resources" class="calibre16">Java 7’s try with resources</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> stream</span> = Files.newInputStream(Paths.<span class="hljs-keyword">get</span>(<span class="hljs-string">"/some/file.txt"</span>))
stream.buffered().reader().use { reader -&gt;
    println(reader.readText())
}
</code></pre>
<h3 id="需要泛型信息的泛型函数的方便形式" class="calibre16">需要泛型信息的泛型函数的方便形式</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-comment">//  public final class Gson {</span>
<span class="hljs-comment">//     ...</span>
<span class="hljs-comment">//     public &lt;T&gt; T fromJson(JsonElement json, Class&lt;T&gt; classOfT) throws JsonSyntaxException {</span>
<span class="hljs-comment">//     ...</span>

<span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T: Any&gt;</span> Gson.<span class="hljs-comment">fromJson</span><span class="hljs-params">(json)</span>: T = this.<span class="hljs-comment">fromJson</span><span class="hljs-params">(json, T:<span class="hljs-type">:class.java</span>)</span></span>
</code></pre>
<h3 id="产生一个可能为空的布尔值" class="calibre16">产生一个可能为空的布尔值</h3>
<pre class="calibre17"><code class="lang-kotlin pcalibre4 pcalibre3"><span class="hljs-variable"><span class="hljs-keyword">val</span> b</span>: <span class="hljs-keyword">Boolean</span>? = ...
<span class="hljs-keyword">if</span> (b == <span class="hljs-params">true</span>) {
  ...
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// `b` 是false或者null</span>
}
</code></pre>

        </div>
    
</div>

        
    


</body></html>
